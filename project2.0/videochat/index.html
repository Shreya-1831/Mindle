<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <title>WebRTC Video Chat</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <script src="https://unpkg.com/uuid@9.0.1/dist/umd/uuid.min.js"></script>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;500;600;700&family=Kalam:wght@300;400;700&family=Architects+Daughter&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Firebase SDK -->
    <script type="module" src="firebase-config.js"></script>
    <script type="module" src="script.js" defer></script>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar">
      <div class="container">
        <a class="navbar-brand" href="#">
          <i class="bi bi-camera-video"></i>
          <span>WebRTC Chat</span>
        </a>
        <div class="nav-menu">
          <ul class="nav-links">
            <li class="nav-item">
              <a class="nav-link active" href="#">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Features</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">About</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="theme-dropdown">
                Theme
              </a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#" id="light-theme">Light Theme</a></li>
                <li><a class="dropdown-item" href="#" id="dark-theme">Dark Theme</a></li>
              </ul>
            </li>
          </ul>
          <div id="connection-status">Disconnected</div>
        </div>
        <div class="navbar-toggle">
          <span class="bar"></span>
          <span class="bar"></span>
          <span class="bar"></span>
        </div>
      </div>
    </nav>

    <div class="container main-container">
      <div class="meeting-controls">
        <div class="create-meeting">
          <button id="create-meeting-btn" class="primary-btn">Create Meeting</button>
          <button id="copy-meeting-link-btn" class="secondary-btn" disabled>Copy Meeting Link</button>
        </div>
        <div class="join-meeting">
          <input type="text" id="meeting-id-input" placeholder="Enter Meeting ID" />
          <button id="join-meeting-btn" class="primary-btn">Join Meeting</button>
        </div>
      </div>

      <div class="video-container">
        <div id="videos-grid"></div>
      </div>

      <div class="media-controls">
        <button id="toggle-video-btn" class="control-btn" data-tooltip="Toggle Video">
          <span class="material-icons">videocam</span>
        </button>
        <button id="toggle-audio-btn" class="control-btn" data-tooltip="Toggle Audio">
          <span class="material-icons">mic</span>
        </button>
        <button id="leave-meeting-btn" class="control-btn leave" data-tooltip="Leave Meeting">
          <span class="material-icons">call_end</span>
        </button>
      </div>

      <div id="error-message" class="error-message"></div>
    </div>
    
    <div class="theme-toggle" id="theme-toggle">
      <span class="material-icons">dark_mode</span>
    </div>
    
    <script>
      // Theme toggle functionality
      document.addEventListener('DOMContentLoaded', function() {
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = themeToggle.querySelector('.material-icons');
        const lightThemeBtn = document.getElementById('light-theme');
        const darkThemeBtn = document.getElementById('dark-theme');
        const themeDropdown = document.getElementById('theme-dropdown');
        const navbarToggle = document.querySelector('.navbar-toggle');
        const navMenu = document.querySelector('.nav-menu');
        
        // Check for saved theme preference or use default
        const savedTheme = localStorage.getItem('theme') || 'light';
        
        // Apply saved theme
        if (savedTheme === 'dark') {
          document.body.setAttribute('data-theme', 'dark');
          themeIcon.textContent = 'light_mode';
        }
        
        // Toggle theme with floating button
        themeToggle.addEventListener('click', function() {
          toggleTheme();
        });
        
        // Toggle theme with navbar dropdown
        lightThemeBtn.addEventListener('click', function(e) {
          e.preventDefault();
          document.body.removeAttribute('data-theme');
          localStorage.setItem('theme', 'light');
          themeIcon.textContent = 'dark_mode';
        });
        
        darkThemeBtn.addEventListener('click', function(e) {
          e.preventDefault();
          document.body.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
          themeIcon.textContent = 'light_mode';
        });
        
        // Toggle mobile menu
        navbarToggle.addEventListener('click', function() {
          navMenu.classList.toggle('active');
          navbarToggle.classList.toggle('active');
        });
        
        // Handle dropdown
        themeDropdown.addEventListener('click', function(e) {
          e.preventDefault();
          const dropdown = themeDropdown.nextElementSibling;
          dropdown.classList.toggle('show');
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
          if (!e.target.matches('.dropdown-toggle') && !e.target.closest('.dropdown-menu')) {
            const dropdowns = document.querySelectorAll('.dropdown-menu');
            dropdowns.forEach(dropdown => {
              dropdown.classList.remove('show');
            });
          }
        });
        
        function toggleTheme() {
          if (document.body.getAttribute('data-theme') === 'dark') {
            document.body.removeAttribute('data-theme');
            localStorage.setItem('theme', 'light');
            themeIcon.textContent = 'dark_mode';
          } else {
            document.body.setAttribute('data-theme', 'dark');
            localStorage.setItem('theme', 'dark');
            themeIcon.textContent = 'light_mode';
          }
        }
      });
    </script>
  </body>
</html>